use indoc::indoc;
use std::convert::TryInto;
//use regex::Regex;

fn main() {
    let test = indoc! {"forward 5
    down 5
    forward 8
    up 3
    down 8
    forward 2"};

    let test_res = part_1(test);
    assert_eq!(test_res.hpos, 15);
    assert_eq!(test_res.depth, 60);

    let input = indoc! {"forward 8
    forward 3
    forward 8
    down 6
    forward 3
    up 6
    down 3
    down 8
    down 5
    down 1
    down 4
    up 4
    forward 7
    forward 7
    down 8
    forward 8
    forward 2
    forward 4
    forward 6
    down 2
    forward 1
    down 2
    down 6
    up 4
    forward 4
    forward 4
    down 1
    down 1
    forward 8
    down 9
    forward 4
    down 4
    forward 9
    down 9
    forward 7
    forward 4
    forward 4
    down 7
    forward 9
    up 5
    forward 7
    forward 4
    up 5
    up 6
    down 9
    forward 3
    forward 3
    forward 5
    up 3
    forward 8
    down 9
    forward 3
    forward 5
    down 2
    forward 7
    forward 8
    forward 8
    up 3
    down 9
    forward 2
    forward 5
    forward 4
    up 1
    down 3
    forward 7
    forward 4
    up 3
    down 8
    up 8
    forward 7
    forward 7
    down 2
    down 7
    forward 3
    forward 1
    down 7
    down 4
    down 9
    forward 5
    down 9
    up 8
    down 9
    down 7
    forward 2
    down 5
    down 6
    forward 3
    forward 2
    forward 3
    forward 2
    down 4
    up 1
    forward 6
    down 2
    forward 2
    down 5
    up 1
    up 8
    forward 5
    forward 6
    up 8
    down 4
    forward 4
    down 3
    forward 5
    forward 5
    forward 8
    forward 3
    up 1
    down 9
    up 4
    up 5
    down 3
    down 9
    up 6
    down 1
    down 2
    down 3
    down 6
    up 5
    forward 9
    forward 6
    forward 6
    forward 4
    forward 7
    up 6
    down 2
    down 9
    down 9
    forward 4
    down 9
    forward 2
    down 4
    down 8
    down 3
    up 1
    down 2
    down 7
    down 1
    down 5
    up 5
    forward 3
    forward 2
    down 2
    up 4
    up 9
    forward 5
    up 9
    down 9
    forward 1
    down 4
    forward 6
    down 2
    forward 7
    forward 2
    down 6
    forward 9
    down 9
    down 8
    forward 7
    down 3
    down 3
    down 5
    forward 5
    up 9
    up 5
    down 1
    forward 9
    down 3
    down 6
    forward 3
    up 4
    up 1
    down 3
    down 1
    up 6
    forward 4
    up 4
    forward 5
    down 3
    down 5
    forward 4
    down 1
    up 6
    down 5
    forward 1
    forward 6
    down 5
    forward 1
    forward 4
    forward 2
    down 1
    down 3
    down 9
    down 9
    down 8
    forward 4
    down 5
    forward 6
    up 6
    down 3
    forward 1
    down 9
    forward 4
    down 2
    up 5
    down 4
    forward 1
    forward 2
    down 6
    forward 3
    down 9
    forward 6
    forward 1
    forward 7
    up 1
    up 7
    up 2
    forward 4
    up 3
    down 4
    up 1
    down 3
    forward 1
    down 5
    up 6
    forward 6
    forward 6
    up 3
    up 2
    down 8
    down 2
    down 2
    down 7
    forward 8
    up 2
    up 2
    up 5
    down 6
    up 3
    down 9
    forward 7
    down 7
    forward 8
    forward 2
    forward 5
    up 5
    up 1
    forward 5
    up 2
    up 3
    up 2
    up 3
    down 3
    down 2
    forward 1
    up 1
    down 4
    up 8
    forward 5
    down 9
    forward 8
    up 1
    forward 7
    forward 7
    up 7
    up 6
    up 6
    down 5
    down 3
    up 4
    up 1
    down 9
    down 9
    forward 4
    down 7
    forward 2
    forward 8
    forward 1
    down 9
    forward 2
    forward 5
    up 5
    down 5
    down 6
    forward 1
    down 4
    forward 9
    up 3
    down 4
    forward 7
    forward 1
    forward 3
    forward 6
    down 1
    forward 3
    up 5
    up 6
    down 3
    forward 5
    forward 8
    forward 4
    down 9
    forward 2
    forward 4
    down 8
    forward 6
    down 7
    up 7
    forward 1
    down 8
    forward 5
    forward 7
    up 3
    forward 7
    forward 2
    up 5
    forward 3
    down 4
    up 5
    down 6
    up 6
    forward 6
    up 1
    up 7
    up 8
    forward 4
    down 6
    down 8
    up 8
    down 2
    forward 3
    forward 9
    down 9
    down 6
    down 2
    up 4
    forward 5
    forward 6
    forward 5
    down 5
    forward 5
    down 2
    down 9
    down 3
    down 4
    forward 2
    forward 7
    down 7
    down 2
    down 4
    down 8
    up 6
    down 7
    forward 2
    up 6
    forward 6
    down 4
    up 8
    forward 1
    up 2
    forward 6
    forward 7
    down 2
    down 4
    down 3
    down 2
    forward 5
    down 4
    forward 6
    forward 6
    down 8
    forward 7
    forward 1
    forward 1
    forward 4
    forward 7
    forward 8
    down 2
    forward 9
    up 7
    forward 1
    down 1
    forward 2
    forward 2
    up 4
    forward 3
    down 1
    down 4
    down 3
    forward 8
    forward 8
    forward 9
    forward 4
    down 6
    up 6
    up 7
    up 7
    down 1
    up 1
    up 9
    up 7
    down 9
    forward 4
    up 8
    down 5
    up 3
    down 2
    forward 4
    forward 6
    up 7
    up 2
    down 5
    down 3
    down 9
    forward 1
    down 1
    down 6
    down 3
    forward 9
    down 3
    up 6
    up 4
    up 6
    down 6
    up 7
    down 5
    up 4
    up 3
    up 3
    up 2
    forward 1
    forward 5
    forward 8
    down 2
    up 9
    forward 6
    forward 8
    up 3
    down 3
    forward 7
    forward 4
    down 7
    up 2
    down 1
    down 5
    forward 8
    down 6
    down 2
    down 9
    down 5
    up 7
    up 5
    forward 7
    down 8
    down 5
    forward 7
    up 5
    up 1
    down 4
    forward 1
    up 3
    forward 7
    forward 9
    down 7
    forward 4
    down 9
    down 2
    up 2
    forward 2
    down 6
    forward 3
    down 5
    up 8
    forward 5
    up 5
    forward 1
    down 4
    forward 7
    down 8
    forward 7
    up 2
    forward 1
    forward 2
    down 7
    forward 7
    forward 5
    up 3
    down 8
    forward 8
    up 6
    up 2
    forward 9
    down 7
    up 6
    down 1
    up 5
    forward 4
    forward 9
    forward 6
    forward 3
    forward 3
    forward 1
    forward 8
    down 6
    forward 3
    up 2
    up 6
    down 3
    down 7
    forward 5
    down 2
    up 9
    up 3
    down 1
    down 3
    up 7
    up 5
    down 6
    down 5
    up 2
    down 1
    down 2
    forward 1
    down 1
    forward 1
    down 1
    up 5
    up 4
    forward 1
    down 7
    forward 4
    down 6
    forward 2
    forward 1
    forward 4
    forward 9
    down 7
    forward 7
    down 7
    down 5
    forward 7
    forward 3
    forward 8
    up 4
    forward 9
    down 1
    down 9
    forward 3
    down 7
    forward 1
    forward 8
    up 7
    forward 5
    down 8
    forward 3
    forward 6
    forward 6
    up 5
    forward 7
    up 3
    down 9
    forward 4
    forward 4
    forward 1
    down 2
    down 9
    forward 8
    forward 8
    down 9
    forward 5
    up 4
    down 6
    forward 3
    up 4
    down 5
    down 2
    down 3
    down 2
    up 1
    up 9
    up 3
    forward 5
    forward 7
    down 1
    down 5
    up 1
    forward 8
    down 5
    forward 8
    forward 8
    down 2
    forward 2
    forward 7
    forward 3
    forward 6
    up 9
    down 3
    forward 7
    down 5
    forward 3
    up 1
    down 3
    down 9
    forward 5
    forward 5
    up 5
    down 3
    down 3
    up 1
    forward 6
    up 1
    up 6
    forward 5
    down 3
    down 9
    forward 1
    down 5
    up 5
    down 7
    down 7
    down 6
    down 2
    up 7
    down 3
    forward 2
    up 6
    down 2
    forward 6
    forward 9
    down 6
    down 4
    down 5
    down 7
    forward 9
    up 2
    down 2
    down 4
    forward 4
    down 9
    forward 3
    forward 8
    forward 6
    up 5
    down 2
    down 7
    forward 7
    up 6
    down 4
    up 8
    forward 2
    down 8
    forward 7
    up 8
    up 5
    up 8
    down 1
    forward 4
    forward 7
    down 5
    forward 1
    forward 5
    down 9
    down 6
    up 8
    up 5
    down 7
    down 4
    forward 4
    forward 2
    forward 4
    down 1
    up 4
    down 5
    down 4
    up 5
    forward 2
    up 3
    down 9
    down 1
    down 4
    up 1
    up 7
    down 5
    forward 9
    down 5
    down 7
    down 2
    down 8
    forward 7
    down 5
    down 6
    forward 3
    down 8
    down 5
    down 9
    up 6
    up 2
    down 9
    down 6
    down 7
    forward 8
    down 8
    forward 4
    up 8
    forward 3
    down 2
    up 2
    forward 4
    down 9
    down 2
    up 6
    down 4
    forward 6
    down 7
    forward 5
    forward 4
    down 3
    up 6
    forward 7
    forward 1
    up 6
    down 6
    forward 5
    forward 3
    down 8
    up 8
    up 8
    forward 5
    forward 1
    up 1
    forward 3
    up 6
    forward 2
    down 8
    forward 8
    up 8
    forward 1
    forward 6
    forward 8
    up 7
    up 3
    forward 8
    forward 5
    down 4
    down 4
    forward 8
    up 1
    forward 5
    down 9
    forward 2
    down 2
    down 3
    forward 1
    down 2
    up 3
    down 1
    up 1
    up 1
    forward 8
    forward 5
    forward 2
    up 1
    down 9
    up 7
    down 1
    forward 9
    up 4
    forward 5
    forward 5
    forward 8
    down 1
    forward 3
    forward 4
    forward 8
    up 2
    forward 5
    down 8
    forward 5
    up 7
    forward 3
    forward 2
    forward 3
    up 7
    up 4
    up 9
    forward 7
    forward 1
    up 6
    up 5
    down 8
    forward 3
    down 5
    forward 7
    forward 3
    up 9
    forward 9
    forward 7
    up 2
    down 7
    forward 4
    down 9
    up 8
    up 3
    down 4
    down 1
    forward 4
    up 3
    down 6
    down 2
    forward 8
    up 1
    forward 5
    up 7
    down 5
    forward 9
    forward 6
    forward 9
    down 3
    up 8
    forward 6
    forward 4
    forward 2
    forward 2
    down 8
    up 5
    down 4
    down 6
    forward 3
    forward 6
    forward 1
    forward 3
    down 8
    down 5
    up 3
    down 1
    down 7
    forward 8
    forward 1
    down 6
    down 9
    forward 2
    up 5
    down 6
    up 6
    down 5
    down 8
    forward 1
    down 3
    forward 1
    forward 8
    forward 2
    down 4
    forward 1
    down 6
    down 6
    forward 3
    up 7
    forward 5
    up 1
    up 4
    forward 7
    forward 1
    down 5
    forward 2
    down 1
    forward 4
    forward 2
    forward 5
    up 2
    up 1
    forward 2
    down 4
    down 5
    forward 6
    forward 1
    down 7
    down 6
    down 2
    forward 5
    forward 6
    up 8
    up 6
    forward 2
    forward 6
    down 9
    down 4
    forward 1
    down 3
    down 1
    up 4
    down 8
    forward 3
    down 5
    up 4
    down 5
    up 3
    down 1
    down 1
    down 9
    forward 8
    up 8
    down 2
    forward 9
    down 8
    down 4
    up 4
    up 9
    up 4
    forward 8
    forward 9
    forward 3
    forward 2
    down 2
    forward 5
    down 6
    down 2
    down 9
    forward 3
    up 4
    forward 8
    up 9
    forward 2
    forward 1
    down 3
    up 1
    up 7
    down 3
    up 2
    down 2
    up 2
    forward 4
    down 7
    forward 2
    forward 4
    forward 3
    down 6
    forward 4
    down 3
    forward 2
    down 1
    up 4
    down 8
    up 3
    forward 4
    up 6
    forward 5
    forward 3
    forward 1
    up 2
    forward 4
    forward 7
    down 3
    forward 9
    up 7
    down 9
    forward 2
    forward 4
    down 9
    down 1
    up 3
    forward 2
    forward 7
    down 7
    forward 9
    forward 5
    forward 7
    forward 2
    forward 3
    forward 4
    forward 5
    forward 6
    down 1
    forward 8
    down 4
    down 6
    up 8
    up 5
    forward 5
    down 9
    down 2
    down 2
    forward 7
    forward 8
    up 8
    down 4
    up 5
    forward 1
    down 5
    forward 3
    up 3
    down 6
    forward 5
    up 3
    up 5
    forward 4
    forward 2
    up 6
    down 9
    forward 7"};
    let part_1_result = part_1(input);
    println!("part 1: {}", part_1_result.hpos * part_1_result.depth);

}

struct Submarine {
    hpos: i32,
    depth: i32,
    aim: i32,
}

impl Submarine {
    fn new() -> Submarine {
        Submarine {
            hpos:0, 
            depth: 0,
            aim: 0
        }
    }
}

fn part_1(directions: &str) -> Submarine {
    let mut res = Submarine::new();
    for line in directions.lines() {
        if line.contains("forward") {
            let size: i32 = line.chars().nth(8).unwrap().to_digit(10).unwrap().try_into().unwrap();
            res.hpos += size;
            res.depth += res.aim * size;
        }
        else if line.contains("down") {
            let size: i32 = line.chars().nth(5).unwrap().to_digit(10).unwrap().try_into().unwrap();
            res.aim += size;
        }
        else if line.contains("up") {
            let size: i32 = line.chars().nth(3).unwrap().to_digit(10).unwrap().try_into().unwrap();
            res.aim -= size;
        }

    }
    res
}
